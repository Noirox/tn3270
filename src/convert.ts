/**
 * Conversion between EBCDIC and ASCII
 *
 * @see https://stackoverflow.com/questions/25367120/
          example-ebcdic-file-for-java-program-to-convert-ebcdic-to-ascii
 */

/** NOTE: starts at position 64 */
const ebcdic: any[] = [
  ' ',
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  '¢',
  '.',
  '<',
  '(',
  '+',
  '|',
  '&',
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  '!',
  '$',
  '*',
  ')',
  ';',
  '¬',
  '-',
  '/',
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  ',',
  '%',
  '_',
  '>',
  '?',
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  ':',
  '#',
  '@',
  '\'',
  '=',
  '\"',
  null,
  'a',
  'b',
  'c',
  'd',
  'e',
  'f',
  'g',
  'h',
  'i',
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  'j',
   'k',
   'l',
   'm',
   'n',
   'o',
   'p',
   'q',
   'r',
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  's',
  't',
  'u',
  'v',
  'w',
  'x',
  'y',
  'z',
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  '`',

  null,
  null,
  null,
  null,
  null,
  null,
  null,
  'A',
  'B',
  'C',
  'D',
  'E',
  'F',
  'G',
  'H',
  'I',
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  'J',
   'K',
   'L',
   'M',
   'N',
   'O',
   'P',
   'Q',
   'R',
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  null,
  'S',
  'T',
  'U',
  'V',
  'W',
  'X',
  'Y',
  'Z',
  null,
  null,
  null,
  null,
  null,
  null,
  '0',
  '1',
  '2',
  '3',
  '4',
  '5',
  '6',
  '7',
  '8',
  '9',
  null,
  null,
  null,
  null,
  null,
  null
];

// reverse engineer ascii
const ascii = new Array(256);

for (let i = 0; i < ebcdic.length; i++) {
  if (ebcdic[i] !== null)
    ascii[ebcdic[i].charCodeAt(0)] = i + 64;
}

/**
 * Convert from ASCII to EBCDIC
 */

export function a2e(a: string): Uint8Array {
  const e = new Uint8Array(a.length);
  for (let i = 0; i < a.length; i++)
    e[i] = ascii[a.charCodeAt(i)];
  return e;
}

/**
 * Convert from EBCDIC to ASCII
 */

export function e2a(e: Uint8Array): string {
  let a = '';
  for (let i = 0; i < e.length; i++)
    a += ebcdic[e[i] - 64];
  return a;
}
